<!DOCTYPE html>
<html lang="pl" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Analityka - SpaceControll</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
<div th:replace="~{fragments.html :: menu}"></div>
<div class="container mt-4"><h2>Analityka</h2>
    <form method="get" th:action="@{/analytics}" class="row g-3 align-items-end mb-4">
        <div class="col-auto"><label for="from" class="form-label mb-0">Od:</label>
            <input type="datetime-local" class="form-control" id="from" name="from"
                   th:value="${#temporals.format(from, 'yyyy-MM-dd''T''HH:mm')}"/>
        </div>
        <div class="col-auto"><label for="to" class="form-label mb-0">Do:</label>
            <input type="datetime-local" class="form-control" id="to" name="to"
                   th:value="${#temporals.format(to, 'yyyy-MM-dd''T''HH:mm')}"/>
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-outline-primary">Pokaż</button>
        </div>
    </form>
    <div class="row g-3">
        <div class="col-md-6">
            <div class="card p-3"><h5>Wykorzystanie (utilization)</h5>
                <p th:text="'Zajęte minuty: ' + ${util.usedMinutes} + ' / Dostępne: ' + ${util.availableMinutes}"></p>
                <div class="progress">
                    <div class="progress-bar" role="progressbar"
                         th:style="'width:' + ${#numbers.formatDecimal(util.utilization * 100, 0, 0)} + '%'"
                         th:text="${#numbers.formatDecimal(util.utilization * 100, 1, 1)} + '%'"></div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card p-3"><h5>No-show rate</h5>
                <p th:text="'No-show: ' + ${noshow.numerator} + ' z ' + ${noshow.denominator}"></p></div>
        </div>
        <div class="col-md-6">
            <div class="card p-3"><h5>Cancellation rate</h5>
                <p th:text="'Anulacje: ' + ${cancel.numerator} + ' z ' + ${cancel.denominator}"></p></div>
        </div>
        <div class="col-md-6">
            <div class="card p-3"><h5>Dopasowanie pojemności (right-sizing)</h5>
                <p th:text="'Śr. nadmiar miejsc: ' + ${#numbers.formatDecimal(rightSizing.avgDifference, 1, 1)}
                + ' (N=' + ${rightSizing.sampleSize} + ')'"></p>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card p-3"><h5>Szczyt równoległych rezerwacji</h5>
                <p th:text="'Peak: ' + ${peakOccupancy.peak} + ' o '
                + ${#temporals.format(peakOccupancy.at, 'yyyy-MM-dd HH:mm')}"></p>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>